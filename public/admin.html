<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Painel Administrativo - EdCasa</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  font-family: Arial, sans-serif;
  background: #111;
  color: #fff;
  padding: 20px;
  max-width: 600px;
  margin: auto;
}
h1 { text-align: center; }
.box {
  background: #1c1c1c;
  padding: 15px;
  border-radius: 10px;
  margin-bottom: 15px;
}
input, select, button {
  width: 100%;
  padding: 10px;
  margin-top: 8px;
  border-radius: 8px;
  border: none;
  font-size: 15px;
}
button {
  background: #25d366;
  font-weight: bold;
}
.item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #222;
  padding: 8px;
  border-radius: 6px;
  margin-top: 6px;
}
.item span { flex: 1; }
.item button {
  background: #e74c3c;
  width: auto;
  padding: 6px 10px;
}
</style>
</head>
<body>

<h1>Painel do Cardápio</h1>

<div class="box">
  <h2>Novo item</h2>

  <select id="categoria">
    <option value="">Categoria</option>
    <option value="prato">Prato principal</option>
    <option value="acompanhamento">Acompanhamento</option>
    <option value="proteina">Proteína</option>
  </select>

  <input id="nome" placeholder="Nome do item">
  <input id="preco" type="number" step="0.01" placeholder="Preço (ex: 25)">

  <button onclick="adicionar()">Adicionar</button>
</div>

<div class="box">
  <h2>Itens cadastrados</h2>
  <div id="lista"></div>
</div>

<script>
async function carregar() {
  const res = await fetch("/api/cardapio");
  const dados = await res.json();

  const lista = document.getElementById("lista");
  lista.innerHTML = "";

  dados.forEach(item => {
    const div = document.createElement("div");
    div.className = "item";

    div.innerHTML = `
      <span>${item.categoria} - ${item.nome} (R$ ${item.preco})</span>
      <button onclick="remover(${item.id})">X</button>
    `;

    lista.appendChild(div);
  });
}

async function adicionar() {
  const categoria = document.getElementById("categoria").value;
  const nome = document.getElementById("nome").value;
  const preco = document.getElementById("preco").value;

  if (!categoria || !nome || !preco) {
    alert("Preencha todos os campos");
    return;
  }

  await fetch("/api/cardapio", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ categoria, nome, preco })
  });

  document.getElementById("nome").value = "";
  document.getElementById("preco").value = "";

  carregar();
}

async function remover(id) {
  await fetch("/api/cardapio/" + id, { method: "DELETE" });
  carregar();
}

carregar();
</script>

</body>
</html>
